type extmodule_device, dev_type;
type extmodule, domain, mlstrustedsubject, binderservicedomain, coredomain;
type extmodule_exec, file_type, exec_type, system_file_type;
type extmodule_service, service_manager_type;

init_daemon_domain(extmodule);
add_service(extmodule,extmodule_service);
binder_use(extmodule);

allow extmodule system_file:file {execute_no_trans};
allow extmodule system_data_file:dir {write create add_name};
allow extmodule system_data_file:file {read open};
allow extmodule self:capability {chown fowner fsetid net_raw};
allow extmodule self:capability2 {wake_alarm};
allow extmodule property_socket:sock_file {write};
allow extmodule init:unix_stream_socket {connectto};
allow extmodule system_prop:property_service {set};
allow extmodule system_prop:file {read getattr map open};
allow extmodule extmodule:tcp_socket {read write create getattr bind connect listen accept getopt setopt};
allow extmodule port:tcp_socket {name_bind};
allow extmodule node:tcp_socket {node_bind};
allow extmodule fwmarkd_socket:sock_file {write};
allow extmodule netd:unix_stream_socket {connectto};
allow extmodule sysfs_agold:file {read write getattr open};
allow extmodule shell_exec:file {read getattr map execute execute_no_trans open};
allow extmodule extmodule_device:dir {read write add_name open};
allow extmodule extmodule_device:file {read write create open};
allow extmodule extmodule_device:chr_file {read write open};
allow extmodule audio_device:dir {search};
allow extmodule audio_device:chr_file {ioctl read write getattr setattr map open};
allow extmodule ttyACM_device:chr_file {ioctl read write getattr setattr open};
allow extmodule storage_file:lnk_file {read};
allow extmodule tmpfs:dir {search};
allow extmodule sdcardfs:dir {search};
allow extmodule sdcardfs:file {read write getattr open};
allow extmodule mnt_user_file:dir {search};
allow extmodule mnt_user_file:lnk_file {read write};
allow extmodule media_rw_data_file:dir {read search open};
allow extmodule media_rw_data_file:file {read write getattr open};
allow extmodule usb_device:dir {read write search open};
allow extmodule usb_device:chr_file {ioctl read write open};
allow extmodule sysfs:dir {read open};
allow extmodule toolbox_exec:file {read getattr map execute execute_no_trans open};
allow extmodule extmodule_exec:file {getattr execute execute_no_trans};
